"0","# set up a local Spark connection"
"0","sc <- spark_connect(master = ""local"")"
"2","* Using Spark: 3.5.1
"
"0","# copying datasets into Spark"
"0","city <- copy_to(sc, count_city, overwrite = TRUE)"
"0","time <- copy_to(sc, timeseries_long, overwrite = TRUE)"
"0",""
"0","# merging data"
"0","covid_full <- time %>%"
"0","  left_join(city, by = ""Combined_Key"")"
"0",""
"0","# selected countries"
"0","sel_countries <- c(""Germany"", ""China"", ""Japan"", ""United Kingdom"", ""US"", ""Brazil"", ""Mexico"")"
"0","covid <- covid_full %>%"
"0","  filter(Country_Region %in% sel_countries)"
